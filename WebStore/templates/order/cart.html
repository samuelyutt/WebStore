{% extends 'base.html' %}
{% block content %}

<h1>Cart</h1>

<ol>
{% for item in cart_items %}
    <li>
        <a href="{% url 'products:detail' item.product.id %}">{{ item.product }}</a>
        <p>${{ item.product.unit_price }} * {{ item.amount }}</p>
        <p>{{ item.product.inventory_quantity }} </p>
        {% if item.amount < item.product.inventory_quantity %}
            <form action="{% url 'order:cart_item_edit' %}" method="post">{% csrf_token %}
                <input type="hidden" name="product_id" value="{{ item.product.id }}">
                <input type="hidden" name="amount" value="1">
                <input type="submit" value="+">
            </form>
        {% elif item.amount > item.product.inventory_quantity %}
            <p>庫存不足</p>
        {% endif %}
        <form action="{% url 'order:cart_item_edit' %}" method="post">{% csrf_token %}
            <input type="hidden" name="product_id" value="{{ item.product.id }}">
            <input type="hidden" name="amount" value="-1">
            <input type="submit" value="-">
        </form>
        <form action="{% url 'order:cart_item_edit' %}" method="post">{% csrf_token %}
            <input type="hidden" name="product_id" value="{{ item.product.id }}">
            <input type="hidden" name="amount" value="-{{ item.amount }}">
            <input type="submit" value="Remove">
        </form>
    </li>
{% endfor %}
</ol>

{% if not is_not_valid %}
    <a href="{% url 'order:create' %}">Create order</a>
{% endif %}

{% endblock %}